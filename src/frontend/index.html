<html lang='en'>
    <head>
        <meta charset='UTF-8' />
        <meta name='viewport' content='width=device-width, initial-scale=1.0' />
        <meta name='theme-color' content='#2d2d2d' />
        <meta name='mobile-web-app-capable' content='yes' />
        <meta name='apple-mobile-web-app-capable' content='yes' />
        <meta name='apple-mobile-web-app-status-bar-style' content='black-translucent' />
        <meta name='apple-mobile-web-app-title' content='Frontline' />
        <link rel='manifest' href='/manifest.webmanifest' />
        <link rel='apple-touch-icon' href='/assets/generated/app-icon.dim_512x512.png' />
        <link rel='icon' type='image/png' sizes='192x192' href='/assets/generated/app-icon.dim_192x192.png' />
        <link rel='icon' type='image/png' sizes='512x512' href='/assets/generated/app-icon.dim_512x512.png' />
        <title>Frontline Distributors</title>
    </head>
    <body>
        <div id='root'></div>
        <script type='module' src='/src/main.tsx'></script>
        <script>
            // Service worker registration with build ID for cache busting
            if ('serviceWorker' in navigator) {
                const urlParams = new URLSearchParams(window.location.search);
                const noSW = urlParams.get('nosw') === '1';
                
                if (noSW) {
                    console.log('[SW] Service worker disabled via ?nosw=1 parameter');
                    navigator.serviceWorker.getRegistrations().then(registrations => {
                        registrations.forEach(reg => reg.unregister());
                    });
                } else {
                    const buildId = '22';
                    const swUrl = `/sw.js?buildId=${buildId}`;
                    
                    window.addEventListener('load', () => {
                        navigator.serviceWorker.register(swUrl)
                            .then(registration => {
                                console.log('[SW] Service worker registered successfully with build ID:', buildId);
                                
                                registration.addEventListener('updatefound', () => {
                                    console.log('[SW] Update found, new service worker installing...');
                                });
                            })
                            .catch(error => {
                                console.error('[SW] Service worker registration failed:', error);
                            });
                    });
                }
            }
        </script>
    </body>
</html>
